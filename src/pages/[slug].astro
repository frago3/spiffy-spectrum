---
import { getCollection, type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";
import Player from "../components/player/Player.svelte";

export const getStaticPaths = async () => {
    const albums = await getCollection("albums");
    return albums.map((album) => {
        return {
            params: { slug: album.id },
            props: { album: album },
        };
    });
};

type Props = {
    album: CollectionEntry<"albums">;
};

const { album } = Astro.props;
// const { id, data: { cover, name, tracklist } } = Astro.props.album;
---

<Layout title={`Pilotopardo - ${album.data.name}`}>
    <main class="px-3 pb-5 mx-auto md:w-3/4 md:p-0 md:pt-7 md:pb-10">
        <h1 class="text-3xl mb-6 hidden md:block">{album.data.name}</h1>

        <div class="flex flex-col gap-x-9 md:flex-row-reverse">
            <div class="md:w-1/2">
                <Image
                    src={album.data.cover}
                    alt={album.id}
                    class="w-full"
                />
            </div>
            <div class="flex flex-col md:w-1/2">
                <h1 class="text-2xl mt-5 mb-4 md:hidden">
                    {album.data.name}
                </h1>
                <Player tracklist={album.data.tracklist} albumName={album.data.name} client:load/>
            </div>
        </div>
    </main>
</Layout>
